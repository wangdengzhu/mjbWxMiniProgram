<!-- pages/evaluate/evaluate.wxml -->
<view class="eval-wrap">
  <view class="eval-title">
    <view class="{{index==1?'active':''}}" data-index="1" bindtap="evalTitleChange">待评价</view>
    <view class="{{index==2?'active':''}}" data-index="2" bindtap="evalTitleChange">已评价</view>
  </view>
</view>
<view style="padding-top: 72rpx;" wx:if="{{isShow}}">
  <!-- 待评价 -->
  <block wx:if="{{!isEvaluated}}">
    <view class="be-eval">
      <view wx:if="{{pendindCommentList.length>0}}">
        <eval-list evaluate-goods="{{pendindCommentList}}" is-show="{{isShowEval}}"></eval-list>
      </view>
      <view wx:else>
        <empty-eval empty-image="https://devskin.manjd.net/miniprogram/images/logistics-empty.png" text="您暂时没有可评价的商品">
          <button class='look-around' bindtap='toIndex'>随便逛逛</button>
        </empty-eval>
      </view>
    </view>
  </block>
  <!-- 已评价 -->
  <block wx:if="{{isEvaluated}}">
    <view class="evaluated">
      <block wx:if="{{commentList.length>0}}">
        <view class="eval-item" wx:for="{{commentList}}" wx:key="{{item.spuid}}">
          <view class="eval-info">
            <view class="ev-personInfo">
              <view class="per-info">
                <image src="{{item.usericon}}"></image>
                <text class="per-name">{{item.nickname}}</text>
              </view>
              <view class="ev-date">
                <text>{{item.createtime}}</text>
              </view>
            </view>
            <view class="ev-start">
              <block wx:for="{{5}}" wx:for-item="startItem" wx:key="index">
                <text class="{{ index < item.stars ? 'active' : ''}}">★</text>
              </block>
            </view>
            <view class="{{item.showTxt ? 'ev-content ev-content2' : 'ev-content'}}">
              <view class="ev-content-text">{{item.filtertext}}</view>
              <view data-index="{{index}}" class="ev-content-btn {{item.showTxt ? '' : 'drop'}}" bindtap="onShowTxt">{{item.showTxt ? '收起' : '展开'}}</view>
            </view>
            <view class="ev-pic">
              <image wx:for="{{item.piclist}}" wx:for-item="picItem" wx:key="index" src="{{picItem}}" data-picarr="{{item.piclist}}" data-pic="{{picItem}}" bindtap="viewPic"></image>
            </view>
            <view class="ev-format">
              <text>{{item.spec}}</text>
            </view>
          </view>
          <view class="goodslist-item" data-spuid="{{item.spuid}}" bindtap='toDetail'>
            <view class="goodslist-pic">
              <image src="{{item.goodslistpicurl}}"></image>
            </view>
            <view class="goodslist-info">
              <view class="gl-top">
                <view class="gl-name-wrap">
                  <text>{{item.title}}</text>
                </view>
                <view class="gl-format">
                  <text>{{item.spec}}</text>
                </view>
              </view>
              <view class="gl-bot">
                <view>
                  <text class="gl-price">￥{{item.salesprice}}</text>
                  <text class="gl-num">x{{item.qty}}</text>
                </view>
              </view>
            </view>
          </view>
        </view>
      </block>
      <view wx:else>
        <empty-eval empty-image="https://devskin.manjd.net/miniprogram/images/logistics-empty.png" text="您暂时没有可评价的商品">
          <button class='look-around' bindtap='toIndex'>随便逛逛</button>
        </empty-eval>
      </view>
    </view>
  </block>
</view>
<view wx:if="{{isShow && (pendindCommentList.length>0 || commentList.length>0 )}}">
  <view class="loading-container" wx:if="loading>0">
    <view class="is-loading" wx:if="{{loading==1}}">
      <view class="loading-icon"></view>
      正在加载中
    </view>
    <view class="no-more" wx:if="{{loading==2}}">没有更多了</view>
  </view>
</view>